-- Script Jar.xHub by FajarGamingOfficial
-- Update v11: Teleport Input Fix

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Jar.xHub",
   LoadingTitle = "Jar.xHub",
   LoadingSubtitle = "by FajarGamingOfficial",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "JarHub",
      FileName = "ConfigJar"
   }
})

-- Variabel
local EspEnabled = false
local EspBoxes = {}
local NameTagEnabled = false
local NameTags = {}

-- TAB 1: PLAYER
local TabMain = Window:CreateTab("PLAYER", 4483362458)

-- SPEED
TabMain:CreateInput({
   Name = "Input Speed",
   PlaceholderText = "Masukkan angka speed...",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
       InputSpeed = Text
   end
})

TabMain:CreateButton({
   Name = "SET SPEED",
   Callback = function()
       if InputSpeed and tonumber(InputSpeed) then
           game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = tonumber(InputSpeed)
           Rayfield:Notify({Title = "Jar.xHub", Content = "Speed set to "..InputSpeed, Duration = 2})
       end
   end
})

-- JUMP
TabMain:CreateInput({
   Name = "Input Jump",
   PlaceholderText = "Masukkan angka jump...",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
       InputJump = Text
   end
})

TabMain:CreateButton({
   Name = "SET JUMP",
   Callback = function()
       if InputJump and tonumber(InputJump) then
           game.Players.LocalPlayer.Character.Humanoid.JumpPower = tonumber(InputJump)
           Rayfield:Notify({Title = "Jar.xHub", Content = "Jump set to "..InputJump, Duration = 2})
       end
   end
})

-- ESP
TabMain:CreateSection({
   Name = "ESP Settings"
})

local function UpdateEsp()
    if not EspEnabled then
        for _, v in pairs(EspBoxes) do
            if v and v.Parent then
                v:Destroy()
            end
        end
        EspBoxes = {}
        return
    end

    for i, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local existingEsp = EspBoxes[player.Name]
            
            if not existingEsp then
                local highlight = Instance.new("Highlight")
                highlight.Name = "JarESP_Player"
                highlight.FillColor = Color3.fromRGB(0, 0, 255)
                highlight.OutlineColor = Color3.fromRGB(255,255,255)
                highlight.FillTransparency = 0.3
                highlight.OutlineTransparency = 0
                highlight.Adornee = player.Character
                highlight.Parent = player.Character
                EspBoxes[player.Name] = highlight
            end
        end
    end
end

TabMain:CreateToggle({
   Name = "ESP (Blue: Player, Green: Monster)",
   CurrentValue = false,
   Flag = "ESPToggle",
   Callback = function(Value)
       EspEnabled = Value
       if Value then
           Rayfield:Notify({Title = "Jar.xHub", Content = "ESP ON!", Duration = 2})
           for _, v in pairs(EspBoxes) do if v and v.Parent then v:Destroy() end end
           EspBoxes = {}
           spawn(function()
               while EspEnabled do
                   UpdateEsp()
                   wait(2)
               end
           end)
       else
           Rayfield:Notify({Title = "Jar.xHub", Content = "ESP OFF", Duration = 2})
           UpdateEsp()
       end
   end
})

-- NAME TAGS
TabMain:CreateToggle({
   Name = "Show Name Tags (Nama di Kepala)",
   CurrentValue = false,
   Flag = "NameTagToggle",
   Callback = function(Value)
       NameTagEnabled = Value
       if Value then
           Rayfield:Notify({Title = "Jar.xHub", Content = "NameTag ON!", Duration = 2})
           spawn(function()
               while NameTagEnabled do
                   local function UpdateNameTags()
                        if not NameTagEnabled then return end
                        -- Bersihkan yang tidak ada lagi
                        for name, tag in pairs(NameTags) do
                            local player = game.Players:FindFirstChild(name)
                            if not player or not player.Character then
                                if tag and tag.Parent then tag:Destroy() end
                                NameTags[name] = nil
                            end
                        end
                        -- Tambah yang baru
                        for i, player in pairs(game.Players:GetPlayers()) do
                            if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
                                if not NameTags[player.Name] then
                                    local bgui = Instance.new("BillboardGui")
                                    bgui.Name = "JarNameTag"
                                    bgui.AlwaysOnTop = true
                                    bgui.Size = UDim2.new(0, 100, 0, 30)
                                    bgui.StudsOffset = Vector3.new(0, 2.5, 0)
                                    bgui.Parent = player.Character.Head
                                    local textLabel = Instance.new("TextLabel")
                                    textLabel.Size = UDim2.new(1, 0, 1, 0)
                                    textLabel.BackgroundTransparency = 1
                                    textLabel.Text = player.Name
                                    textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                                    textLabel.TextStrokeTransparency = 0.5
                                    textLabel.TextScaled = true
                                    textLabel.Font = Enum.Font.GothamBold
                                    textLabel.Parent = bgui
                                    NameTags[player.Name] = bgui
                                end
                            end
                        end
                   end
                   UpdateNameTags()
                   wait(2)
               end
           end)
       else
           Rayfield:Notify({Title = "Jar.xHub", Content = "NameTag OFF", Duration = 2})
           for _, v in pairs(NameTags) do if v and v.Parent then v:Destroy() end end
           NameTags = {}
       end
   end
})

-- TAB 2: TELEPORT (INPUT ONLY - FIX)
local TabTeleport = Window:CreateTab("TELEPORT", 4483342458)

-- 1. Ketik Nama
TabTeleport:CreateInput({
   Name = "Ketik Nama (Lihat di Kepala)",
   PlaceholderText = "User...",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
       TargetNameTP = Text
   end
})

-- 2. Tombol Refresh (Info Saja)
TabTeleport:CreateButton({
   Name = "REFRESH (Jika player baru join)",
   Callback = function()
       Rayfield:Notify({Title = "Jar.xHub", Content = "Script sudah Auto-Detect", Duration = 2})
   end
})

-- 3. Tombol Teleport
TabTeleport:CreateButton({
   Name = "TELEPORT TO PLAYER",
   Callback = function()
       local target = game.Players:FindFirstChild(TargetNameTP)
       local me = game.Players.LocalPlayer

       if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
           if me.Character and me.Character:FindFirstChild("HumanoidRootPart") then
               me.Character.HumanoidRootPart.CFrame = target.Character.HumanoidRootPart.CFrame
               Rayfield:Notify({Title = "Jar.xHub", Content = "Teleport to: "..TargetNameTP, Duration = 3})
           end
       else
           Rayfield:Notify({Title = "Error", Content = "Player '"..TargetNameTP.."' tidak ketemu!", Duration = 3})
       end
   end
})

-- TAB 3: THEME
local TabTheme = Window:CreateTab("THEME", 6034167891) 

TabTheme:CreateDropdown({
   Name = "Select Theme (UI)",
   Options = {"Default", "Grape", "Blue", "Serika"},
   CurrentOption = "Default",
   Flag = "ThemeSelector",
   Callback = function(Option)
   end
})

TabTheme:CreateButton({
   Name = "FORCE DARK MODE",
   Callback = function()
       local mainGui = game.CoreGui:FindFirstChild("RayfieldInterface")
       if mainGui then
           for _, child in pairs(mainGui:GetDescendants()) do
               if child:IsA("Frame") or child:IsA("TextButton") or child:IsA("ScrollingFrame") then
                   pcall(function()
                       child.BackgroundColor3 = Color3.fromRGB(0,0,0)
                   end)
               end
           end
           Rayfield:Notify({Title = "Jar.xHub", Content = "Force Dark Applied!", Duration = 2})
       else
           Rayfield:Notify({Title = "Error", Content = "GUI tidak ditemukan!", Duration = 2})
       end
   end
})

Rayfield:LoadConfiguration()
